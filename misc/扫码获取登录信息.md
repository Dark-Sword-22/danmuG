# 扫码获取登录信息

总的来说，我们的重投软件只是将用户发送弹幕的这一具体操作自动重复（只不过发送前先与其他人协调不要发重复了），这种操作并无魔法，所以与使用软件与使用浏览器一样需要先登录才能发弹幕，从软件的角度说即是需要你输入一个合法的登录信息才能使用。

之前我们写了[这篇说明](https://github.com/Dark-Sword-22/danmuG/blob/main/misc/如何获取模拟登录的ID信息.md)，希望以图文的形式教会小白朋友们两分钟内拿到登录信息的方法。不过受限于其手动操作的形式，总归是不太方便的。经好哥哥提醒我们开发了通过扫码自动获取登录信息的接口，这篇文章是其使用教学。

## 事前准备

首先你需要有一个B站账号，理论上它最好是小号。虽然大号有一定的好处，比如投递弹幕时允许的尺度会更高一些，允许的内容会更长一些。但总的来说毕竟作为一种暴露秘钥的行为，它总是带有某种程度的风险。虽然我们的程序不含任何会发送你秘钥的代码，但理论上这种风险操作最好有小号来完成。

另一点值得注意的就是，虽然我们的投稿策略设定得非常缓和，以求最大限度上避免触发B站的机器人拦截策略。但是毕竟此种行为无法确保绝对安全，一旦被封号的话，似乎封号的是小号会更好一些。

总之你需要在事前准备好以下几项：

1. 一个B站账号
2. 一台电脑，手机无法完成这些操作
3. 一个浏览器，下文教学以Chrome浏览器为例。

## 使用方法

首先打开[cookies-helper.html](https://dark-sword-22.pages.dev/cookie-helper.html)这个网址，默认会弹出一个验证码（为了防止网页被机器人疯狂刷新），输入后点击发送，就会弹出B站登录所需的二维码，基本上它就是把B站的那个码复制一份在这里显示。

此后使用B站手机APP扫码，并点击确认登录，即可确认此码的登录状态，由于此码是代理服务器申请的，也就是说确认后代理服务器会被认为登录成功，从而拿到你的登录信息，经过筛选后，程序运行所需的`SESS_DATA`和`bili_cjt`会被展示在页面上。

## 常见Q&A

- 扫码登录的原理是什么？为什么没有更简洁的获取cookie方式？

一般来说，浏览器有一种默认的安全防护策略，即将网站用来标记用户身份的敏感信息储存在代码不可访问的区域，其目的是防止该敏感信息被网站上形形色色的代码偷窥或修改，从而引发安全问题。在绝大多数情况下这是很好的策略，它保护了大多数没有相关专业知识的朋友们可以安全的网上冲浪。但在我们的特定场景下（需要获取身份信息）则带来了麻烦，我们不能写一段代码，帮助大家自动访问，因为它本身就是不可以被第三方代码访问的。

- 那为什么扫码就可以了？

经由好哥哥提醒，仓库作者（也就是我）原先的思维局限在于，出于安全考量，总是希望将代码（或程序）交由用户运行。这种非中心式的方式可以确保没有任何信息被发送出去，以确保用户的信息安全。不过后来看来似乎也不必如此吹毛求疵，也许我们可以牺牲一定的安全性以提高便利性。 简单来说方案实现的原理类似于，你的朋友（代理服务器）在自己家里打开B站，选择扫码登录，然后将出现的二维码拍照后发给你扫描，如果你扫描成功，那么远在千里之外的他也就登录成功，此时他的身份就从第三方变成了第一方，从而解锁了代码访问的限制，所以之后他可以快速地将登录信息筛选并发给你。

- 有什么安全风险？

总的来说扫码与弹幕投稿工具一样，暴露cookie后理论上需要完全信任服务方不会将你的信息外泄。我们的项目不含任何记录或发送的你身份信息的代码。不过由于没有保证部署的服务与开源代码相同，所以这点其实也没法证明。另外的风险是，由于开源项目涉及多人协同管理，也许某天会出现坏哥哥向网页投放恶意代码，而未被审核人员发现。总的来说作为安全常识，用户在此处的安全防护逻辑应类似于生活中的“贵重物品随身携带”。